<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Traceable Letters - Kids Tracing</title>
<style>
* { box-sizing: border-box; }
body {
    font-family: "Century Gothic", Arial, sans-serif;
    margin: 0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    background: #fff;
    overflow: hidden;
    position: relative;
}

/* Header & Footer */
header, footer {
    background: linear-gradient(135deg, #FFDEE9, #B5FFFC, #FFF6B7, #FFB3BA);
    background-size: 800% 800%;
    animation: gradientAnim 20s ease infinite;
    padding: 15px;
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
}
footer { border-top: 3px solid #ccc; }

@keyframes gradientAnim {
    0% { background-position: 0% 50%; }
    25% { background-position: 50% 100%; }
    50% { background-position: 100% 50%; }
    75% { background-position: 50% 0%; }
    100% { background-position: 0% 50%; }
}
header img { width: 50px; cursor: pointer; }

/* Pen Controls */
#headerControls {
    display: flex;
    gap: 15px;
    align-items: center;
}

/* Buttons styling */
button {
    padding: 12px 18px;
    border-radius: 12px;
    border: 2px solid #fff;
    font-weight: bold;
    cursor: pointer;
    color: white;
    font-size: 18px;
    transition: 0.2s;
}
button:hover { opacity: 0.8; }

.colorBtn {
    width: 50px; height: 50px;
    border-radius: 50%;
    border: 2px solid white;
    cursor: pointer;
}
.colorBtn.red   { background: #ff4d6d; }
.colorBtn.blue  { background: #4da6ff; }
.colorBtn.black { background: #333; }
.colorBtn.undo  { background: #fff; border: 2px solid #333; color: #333; font-weight: bold; font-size: 20px; }

/* Pen size buttons */
.sizeBtn {
    background: linear-gradient(135deg, #FFDEE9, #B5FFFC);
    color: #333;
    font-size: 16px;
}

/* Action buttons */
.action-btn {
    background: linear-gradient(135deg, #FFDEE9, #FFB3BA);
    color: #333;
    border: none;
    font-size: 20px;
    padding: 12px 18px;
}

/* Canvas */
#traceCanvas {
    display: block;
    margin: 0 auto;
    cursor: crosshair;
    background: transparent;
    z-index: 1;
    position: relative;
}

/* Slider */
.slider-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 60px;
    flex: 1;
    z-index: 2;
    position: relative;
}
.arrow {
    font-size: 50px;
    cursor: pointer;
    padding: 10px;
    transition: 0.2s;
}
.arrow:hover { transform: scale(1.2); }

.letter-display-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    min-width: 200px;
}
.letter-display {
    font-size: 65px;
    font-weight: bold;
    display: flex;
    gap: 18px;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 2;
}
.small-letter { font-size: 50px; font-weight: bold; margin-top: 5px; }

.preview-left, .preview-right {
    font-size: 55px;
    font-weight: bold;
    display: flex;
    gap: 12px;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: -10px;
    opacity: 0.75;
}
.preview-left { left: -190px; }
.preview-right { right: -190px; }

/* Footer right buttons */
.right-buttons {
    display: flex;
    gap: 10px;
}

/* Full-screen overlay */
#overlay {
    display: none;
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background-color: rgba(0,0,0,0.85);
    z-index: 999;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    color: white;
    font-family: 'Century Gothic', Arial, sans-serif;
}

#overlay .overlay-box {
    background-color: #fff;
    padding: 60px 100px;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.3);
    color: #333;
}

#overlay h1 {
    font-size: 70px;
    margin: 0 0 25px 0;
}

#overlay button {
    padding: 18px 35px;
    font-size: 22px;
    border:none;
    border-radius: 15px;
    cursor: pointer;
    background: #ff4d6d;
    color: white;
    font-weight: bold;
    transition: 0.2s;
}
#overlay button:hover {
    transform: scale(1.1);
}
</style>
</head>
<body>

<header>
    <a href="index.html"><img src="https://cdn-icons-png.flaticon.com/512/25/25694.png" alt="Home"></a>

    <div id="headerControls">
        <button class="colorBtn red" data-color="red"></button>
        <button class="colorBtn blue" data-color="blue"></button>
        <button class="colorBtn black" data-color="black"></button>
        <button class="colorBtn undo" data-color="undo">&#8630;</button>

        <button class="sizeBtn" data-size="4">S</button>
        <button class="sizeBtn" data-size="8">M</button>
        <button class="sizeBtn" data-size="14">L</button>
    </div>
</header>

<canvas id="traceCanvas"></canvas>

<footer>
    <div class="slider-container">
        <div class="arrow" id="leftArrow">&#9664;</div>

        <div class="letter-display-wrapper">
            <div class="preview-left" id="previewLeft"></div>
            <div id="letter" class="letter-display"><span>I</span><span class="small-letter">i</span></div>
            <div class="preview-right" id="previewRight"></div>
        </div>

        <div class="arrow" id="rightArrow">&#9654;</div>
    </div>

    <div class="right-buttons">
        <button class="action-btn" id="clearBtn">Clear</button>
        <button class="action-btn" id="saveBtn">Save</button>
    </div>
</footer>

<!-- Overlay -->
<div id="overlay">
    <div class="overlay-box">
        <h1>MAGALING!</h1>
        <button id="playAgainBtn">Play Again</button>
    </div>
</div>

<script>
// Letters
const letters = ["Ii","Rr","Hh","Ww","Nn","Ll","Yy","Gg"];
let currentIndex = 0;

// Canvas
const canvas = document.getElementById("traceCanvas");
const ctx = canvas.getContext("2d");

// Pen
let penColor = "red";
let penSize = 12;
let drawing = false;

// Paths storage
let userPaths = [];

// Line Y positions
const linesY = [120, 250, 380];

// Resize
function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = 500;
    drawCanvas();
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// Draw lines
function drawLines() {
    ctx.lineWidth = 4;
    const colors = ["blue", "red", "blue"];
    for (let i = 0; i < 3; i++) {
        ctx.strokeStyle = colors[i];
        ctx.beginPath();
        ctx.moveTo(2, linesY[i]);
        ctx.lineTo(canvas.width - 2, linesY[i]);
        ctx.stroke();
    }
}

// Draw trace letters
function drawTraceLetters(letter) {
    ctx.globalAlpha = 0.6;
    ctx.fillStyle = "blue";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.font = "bold 250px 'Century Gothic', Arial";

    const yPos = linesY[1] + 25;

    ctx.fillText(letter, canvas.width / 4, yPos);
    ctx.fillText(letter, canvas.width / 2, yPos);
    ctx.fillText(letter, canvas.width * 3 / 4, yPos);

    ctx.globalAlpha = 1.0;
}

// Redraw all
function drawCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawLines();
    drawTraceLetters(letters[currentIndex]);

    userPaths.forEach(path => {
        ctx.strokeStyle = path.color;
        ctx.lineWidth = path.size;
        ctx.lineCap = "round";
        ctx.lineJoin = "round";

        ctx.beginPath();
        ctx.moveTo(path.points[0].x, path.points[0].y);
        for (let i = 1; i < path.points.length; i++) {
            ctx.lineTo(path.points[i].x, path.points[i].y);
        }
        ctx.stroke();
    });
}

// Drawing
let currentPath = null;
let lastPos = null;

function getPos(e) {
    const rect = canvas.getBoundingClientRect();
    return e.touches ?
        { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top } :
        { x: e.clientX - rect.left, y: e.clientY - rect.top };
}

function startDraw(e) {
    drawing = true;
    lastPos = getPos(e);

    currentPath = {
        color: penColor,
        size: penSize,
        points: [lastPos]
    };

    e.preventDefault();
}

function draw(e) {
    if (!drawing) return;

    const pos = getPos(e);
    currentPath.points.push(pos);

    ctx.strokeStyle = penColor;
    ctx.lineWidth = penSize;
    ctx.lineCap = "round";
    ctx.lineJoin = "round";

    ctx.beginPath();
    ctx.moveTo(lastPos.x, lastPos.y);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();

    lastPos = pos;
}

function stopDraw() {
    if (drawing && currentPath) userPaths.push(currentPath);
    drawing = false;
    currentPath = null;
}

// Events
canvas.addEventListener("mousedown", startDraw);
canvas.addEventListener("mousemove", draw);
canvas.addEventListener("mouseup", stopDraw);
canvas.addEventListener("mouseleave", stopDraw);
canvas.addEventListener("touchstart", startDraw, { passive: false });
canvas.addEventListener("touchmove", draw, { passive: false });
canvas.addEventListener("touchend", stopDraw);

// Pen buttons
document.querySelectorAll(".colorBtn").forEach(btn => {
    btn.addEventListener("click", () => {
        if (btn.dataset.color === "undo") {
            if (userPaths.length > 0) userPaths.pop();
            drawCanvas();
        } else {
            penColor = btn.dataset.color;
        }
    });
});

document.querySelectorAll(".sizeBtn").forEach(btn => {
    btn.addEventListener("click", () => {
        penSize = parseInt(btn.dataset.size);
    });
});

// Slider
function updateLetter() {
    const big = letters[currentIndex][0];
    const small = letters[currentIndex][1];

    document.getElementById("letter").innerHTML =
        `<span>${big}</span><span class="small-letter">${small}</span>`;

    const prevIndex = (currentIndex - 1 + letters.length) % letters.length;
    const nextIndex = (currentIndex + 1) % letters.length;

    document.getElementById("previewLeft").innerHTML =
        `<span>${letters[prevIndex][0]}</span><span class="small-letter">${letters[prevIndex][1]}</span>`;

    document.getElementById("previewRight").innerHTML =
        `<span>${letters[nextIndex][0]}</span><span class="small-letter">${letters[nextIndex][1]}</span>`;

    drawCanvas();
}

// Arrows
let rightHover, leftHover;

document.getElementById("rightArrow").addEventListener("mouseenter", () => {
    rightHover = setInterval(() => {
        currentIndex = (currentIndex + 1) % letters.length;
        updateLetter();
    }, 500);
});
document.getElementById("rightArrow").addEventListener("mouseleave", () => {
    clearInterval(rightHover);
});

document.getElementById("leftArrow").addEventListener("mouseenter", () => {
    leftHover = setInterval(() => {
        currentIndex = (currentIndex - 1 + letters.length) % letters.length;
        updateLetter();
    }, 500);
});
document.getElementById("leftArrow").addEventListener("mouseleave", () => {
    clearInterval(leftHover);
});

// Clear & Save
document.getElementById("clearBtn").addEventListener("click", () => {
    userPaths = [];
    drawCanvas();
});

document.getElementById("saveBtn").addEventListener("click", () => {
    const tempCanvas = document.createElement("canvas");
    tempCanvas.width = canvas.width;
    tempCanvas.height = canvas.height;

    const tctx = tempCanvas.getContext("2d");
    tctx.fillStyle = "white";
    tctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);

    tctx.drawImage(canvas, 0, 0);

    const link = document.createElement("a");
    link.download = "tracing.png";
    link.href = tempCanvas.toDataURL();
    link.click();

    // Show overlay
    document.getElementById("overlay").style.display = "flex";
});

// Play Again
document.getElementById("playAgainBtn").addEventListener("click", () => {
    document.getElementById("overlay").style.display = "none";
    userPaths = [];
    drawCanvas();
});

// Init
updateLetter();
</script>
</body>
</html>
